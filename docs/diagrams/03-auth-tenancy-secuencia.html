<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { margin: 0; background: #f4f7fb; font-family: Segoe UI, Arial, sans-serif; }
    .wrap { width: 1800px; min-height: 1000px; padding: 40px; }
    .title { font-size: 28px; font-weight: 700; color: #1a2046; margin-bottom: 14px; letter-spacing: .02em; }
    .box { background: #fff; border: 1px solid #d5dfec; border-radius: 14px; padding: 20px; box-shadow: 0 8px 24px rgba(26, 32, 70, .08); }
    .mermaid { font-size: 18px; }
  </style>
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, theme: 'base', themeVariables: { primaryColor: '#eef3fa', primaryTextColor:'#14263f', lineColor:'#26486f', fontFamily: 'Segoe UI' } });
    window.addEventListener('load', () => {
      setTimeout(() => document.body.setAttribute('data-ready', '1'), 1200);
    });
  </script>
</head>
<body>
  <div class="wrap">
    <div class="title">03 Auth Tenancy Secuencia</div>
    <div class="box">
      <pre class="mermaid">ï»¿sequenceDiagram
    participant User as Usuario
    participant FE as Frontend
    participant API as Django API
    participant DB as PostgreSQL
    User-&gt;&gt;FE: Login (email/password)
    FE-&gt;&gt;API: POST /api/auth/token/
    API-&gt;&gt;DB: valida credenciales
    DB--&gt;&gt;API: usuario valido
    API--&gt;&gt;FE: access + refresh JWT
    User-&gt;&gt;FE: operar en tenant X
    FE-&gt;&gt;API: GET /api/services/ + JWT + X-Tenant-ID
    API-&gt;&gt;API: tenant_access valida membership
    API-&gt;&gt;DB: consulta por tenant
    DB--&gt;&gt;API: resultados
    API--&gt;&gt;FE: respuesta autorizada
</pre>
    </div>
  </div>
</body>
</html>
