(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[380],{1385:(e,t,n)=>{Promise.resolve().then(n.bind(n,2590))},2590:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var a=n(5155),s=n(8173),i=n.n(s),r=n(2115),o=n(6046),c=n(5739),l=n(4651);function d(){let e=(0,o.useRouter)(),[t,n]=(0,r.useState)(""),[s,d]=(0,r.useState)(""),[u,m]=(0,r.useState)([]),[h,v]=(0,r.useState)([]),[p,g]=(0,r.useState)([]),[f,x]=(0,r.useState)(""),[j,N]=(0,r.useState)(""),[S,I]=(0,r.useState)(""),[k,y]=(0,r.useState)("2026-02-20T18:00"),[b,w]=(0,r.useState)("2026-02-20T19:00"),[C,_]=(0,r.useState)("Listo"),E=(0,r.useMemo)(()=>{let e=f.trim().toLowerCase();return e?u.filter(t=>[t.name,t.discipline,t.description].join(" ").toLowerCase().includes(e)):u},[f,u]);async function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;try{let[t,a,s]=await Promise.all([(0,c.A)("/services",{token:e,tenantId:n}),(0,c.A)("/clients",{token:e,tenantId:n}),(0,c.A)("/appointments",{token:e,tenantId:n})]);m(t),v(a),g(s),_("Marketplace actualizado")}catch(e){_("Error: ".concat(e.message))}}async function A(){if(!j||!S){_("Selecciona servicio y cliente.");return}try{await (0,c.A)("/appointments",{method:"POST",token:t,tenantId:s,body:{service:Number(j),client:Number(S),start_dt:"".concat(k,":00"),end_dt:"".concat(b,":00"),status:"confirmed"}}),_("Reserva creada correctamente"),await T()}catch(e){_("Error al reservar: ".concat(e.message))}}return(0,r.useEffect)(()=>{let t=(0,l.Ht)();if(!t.token||!t.tenantId){e.replace("/login");return}n(t.token),d(t.tenantId),T(t.token,t.tenantId)},[e]),(0,a.jsxs)("main",{children:[(0,a.jsx)("div",{className:"brand",children:"NILA"}),(0,a.jsx)("div",{className:"brandTag",children:"Strategy \xb7 Technology \xb7 Execution"}),(0,a.jsx)("h1",{className:"sectionTitle",children:"Marketplace"}),(0,a.jsxs)("section",{className:"card",children:[(0,a.jsxs)("div",{className:"formGrid",children:[(0,a.jsx)("input",{className:"input",placeholder:"Buscar por disciplina o profesional",value:f,onChange:e=>x(e.target.value)}),(0,a.jsxs)("select",{className:"select",value:j,onChange:e=>N(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Servicio"}),u.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.discipline,")"]},e.id))]}),(0,a.jsxs)("select",{className:"select",value:S,onChange:e=>I(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Cliente"}),h.map(e=>(0,a.jsx)("option",{value:e.id,children:e.full_name},e.id))]})]}),(0,a.jsxs)("div",{className:"formGrid",style:{marginTop:8},children:[(0,a.jsx)("input",{className:"input",type:"datetime-local",value:k,onChange:e=>y(e.target.value)}),(0,a.jsx)("input",{className:"input",type:"datetime-local",value:b,onChange:e=>w(e.target.value)}),(0,a.jsx)("button",{className:"linkBtn",onClick:A,children:"Reservar turno"})]})]}),(0,a.jsxs)("div",{className:"grid",children:[(0,a.jsxs)("section",{className:"card",children:[(0,a.jsx)("h2",{children:"Servicios"}),(0,a.jsx)("ul",{className:"list",children:E.map(e=>(0,a.jsxs)("li",{children:[e.name," - ",e.discipline," - $",e.price]},e.id))})]}),(0,a.jsxs)("section",{className:"card",children:[(0,a.jsx)("h2",{children:"Mis reservas"}),(0,a.jsx)("ul",{className:"list",children:p.map(e=>(0,a.jsxs)("li",{children:["Turno #",e.id," - ",e.status," - ",new Date(e.start_dt).toLocaleString()]},e.id))})]})]}),(0,a.jsxs)("div",{className:"linkRow",children:[(0,a.jsx)("button",{className:"linkBtn",onClick:()=>T(),children:"Refrescar"}),(0,a.jsx)(i(),{className:"mutedBtn",href:"/client/dashboard",children:"Volver dashboard"}),(0,a.jsx)("button",{className:"mutedBtn",onClick:function(){(0,l.q7)(),e.push("/login")},children:"Cerrar sesion"})]}),(0,a.jsx)("pre",{className:"pre",children:C})]})}},5739:(e,t,n)=>{"use strict";n.d(t,{A:()=>i,e:()=>r});let a="/api";async function s(e,t){let n=e.length>1&&e.endsWith("/")?e.slice(0,-1):e,s=["".concat(a).concat(n),"".concat(a).concat(n,"/")];for(let e=0;e<s.length;e+=1)try{let n=await fetch(s[e],t);if(404!==n.status||e===s.length-1)return n}catch(t){if(e===s.length-1)throw Error("Network error while contacting API")}throw Error("Unexpected API routing state")}async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={};t.token&&(n.Authorization="Bearer ".concat(t.token)),t.tenantId&&(n["X-Tenant-ID"]=t.tenantId),void 0!==t.body&&(n["Content-Type"]="application/json");let a=await s(e,{method:t.method||"GET",headers:n,body:void 0!==t.body?JSON.stringify(t.body):void 0});if(!a.ok){let e=await a.text();throw Error("".concat(a.status," ").concat(a.statusText," :: ").concat(e))}return 204===a.status?{}:a.json()}function r(){return a}},4651:(e,t,n)=>{"use strict";n.d(t,{E1:()=>d,Ht:()=>l,dM:()=>u,q7:()=>m});let a="nila_token",s="nila_tenant_id",i="nila_user",r="nila_remember";function o(e){let t=localStorage.getItem(e);return null!==t?t:sessionStorage.getItem(e)||""}function c(e){localStorage.removeItem(e),sessionStorage.removeItem(e)}function l(){let e;let t=o(a),n=o(s),r=o(i);if(r)try{e=JSON.parse(r)}catch(t){e=void 0}return{token:t,tenantId:n,user:e}}function d(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=t?localStorage:sessionStorage,o=t?sessionStorage:localStorage;n.setItem(a,e.token),n.setItem(s,e.tenantId),e.user&&n.setItem(i,JSON.stringify(e.user)),n.setItem(r,t?"1":"0"),o.removeItem(a),o.removeItem(s),o.removeItem(i),o.removeItem(r)}function u(e){localStorage.setItem(s,e)}function m(){c(a),c(s),c(i),c(r)}},6046:(e,t,n)=>{"use strict";var a=n(6658);n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[173,441,517,358],()=>t(1385)),_N_E=e.O()}]);