(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{6001:(e,a,t)=>{Promise.resolve().then(t.bind(t,2386))},2386:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>o});var s=t(5155),n=t(2115),l=t(6046),r=t(5739),i=t(4651);function o(){let e=(0,l.useRouter)(),a=(0,n.useRef)(null),[t,o]=(0,n.useState)("login"),[c,d]=(0,n.useState)("client"),[u,m]=(0,n.useState)("admin"),[h,p]=(0,n.useState)("admin12345"),[g,x]=(0,n.useState)("admin@nila.local"),[j,f]=(0,n.useState)("Admin NILA"),[N,v]=(0,n.useState)("+5491100000000"),[b,y]=(0,n.useState)(!0),[S,w]=(0,n.useState)({}),[I,k]=(0,n.useState)(!1),[C,E]=(0,n.useState)(!1),[A,T]=(0,n.useState)("Ingresa para usar la plataforma completa."),_="".trim().length>0,P=(0,n.useMemo)(()=>"login"===t?"Ingresar":"Crear cuenta",[t]),O=(0,n.useMemo)(()=>{let e=0;return h.length>=8&&(e+=1),/[A-Z]/.test(h)&&(e+=1),/[0-9]/.test(h)&&(e+=1),/[^A-Za-z0-9]/.test(h)&&(e+=1),e},[h]),G=(0,n.useMemo)(()=>O<=1?"Baja":O<=3?"Media":"Alta",[O]);function R(){e.push("client"===c?"/client/dashboard":"/professional/dashboard")}async function B(e){let[a,t]=await Promise.all([(0,r.A)("/auth/me",{token:e}),(0,r.A)("/tenants",{token:e})]),s=t.find(e=>"demo-center"===e.slug)||t[0];if(!s)throw Error("No hay tenants activos para esta cuenta.");(0,i.E1)({token:e,tenantId:String(s.id),user:a},b),E(!0),T("Sesion iniciada. Tenant activo: ".concat(s.name)),setTimeout(()=>R(),250)}async function D(e){k(!0),T("Autenticando con Google...");try{let a=await (0,r.A)("/auth/google",{method:"POST",body:{id_token:e}});(0,i.E1)({token:a.access,tenantId:String(a.tenant_id),user:a.user},b),E(!0),T("Sesion Google iniciada para ".concat(a.user.email)),setTimeout(()=>R(),250)}catch(e){T("Google error: ".concat(e.message))}finally{k(!1)}}async function L(e){e.preventDefault();let a=function(){let e={};return u.trim()||(e.username="Ingresa tu usuario."),(!h||h.length<8)&&(e.password="La clave debe tener al menos 8 caracteres."),"register"!==t||(g.trim()&&g.includes("@")||(e.email="Ingresa un email valido."),j.trim()||(e.fullName="Ingresa tu nombre completo."),N.trim()||(e.phone="Ingresa tu telefono.")),e}();if(w(a),Object.keys(a).length>0){T("Revisa los campos marcados.");return}k(!0),T("Procesando...");try{"register"===t&&await (0,r.A)("/auth/register",{method:"POST",body:{username:u,password:h,email:g,full_name:j,phone:N}});let e=await (0,r.A)("/auth/token",{method:"POST",body:{username:u,password:h}});await B(e.access)}catch(e){T("Error: ".concat(e.message))}finally{k(!1)}}return(0,n.useEffect)(()=>{if(!_)return;let e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{var e,t;(null===(t=window.google)||void 0===t?void 0:null===(e=t.accounts)||void 0===e?void 0:e.id)&&a.current&&(window.google.accounts.id.initialize({client_id:"",callback:async e=>{await D(e.credential)}}),a.current.innerHTML="",window.google.accounts.id.renderButton(a.current,{type:"standard",theme:"outline",size:"large",text:"continue_with",shape:"pill",width:320}))},document.body.appendChild(e),()=>{e.remove()}},["",_]),(0,s.jsxs)("main",{className:"loginShell",children:[(0,s.jsxs)("section",{className:"loginHero",children:[(0,s.jsx)("div",{className:"brand",children:"NILA"}),(0,s.jsx)("div",{className:"brandTag",children:"Strategy \xb7 Technology \xb7 Execution"}),(0,s.jsx)("h1",{children:"Gestiona tu negocio con una experiencia premium"}),(0,s.jsx)("p",{children:"Agenda, clientes, cobros y operaciones en una sola plataforma. Disenada para profesionales y clientes con una UX clara y accesible."})]}),(0,s.jsxs)("section",{className:"loginPanel card ".concat(C?"authSuccess":""),children:[(0,s.jsxs)("div",{className:"loginHeader",children:[(0,s.jsx)("h2",{children:"Acceso seguro"}),(0,s.jsx)("span",{className:"badge",children:"NILA Platform"})]}),(0,s.jsx)("p",{className:"small",children:"login"===t?"Inicia sesion para entrar a tu espacio de trabajo.":"Crea tu cuenta para comenzar a operar en la plataforma."}),(0,s.jsxs)("div",{className:"portalSwitch",role:"tablist","aria-label":"Seleccionar portal",children:[(0,s.jsxs)("button",{className:"portalCard ".concat("client"===c?"active":""),type:"button",onClick:()=>d("client"),"aria-selected":"client"===c,children:[(0,s.jsx)("span",{className:"portalTitle",children:"Portal Cliente"}),(0,s.jsx)("span",{className:"portalDesc",children:"Reservas, agenda y seguimiento."})]}),(0,s.jsxs)("button",{className:"portalCard ".concat("professional"===c?"active":""),type:"button",onClick:()=>d("professional"),"aria-selected":"professional"===c,children:[(0,s.jsx)("span",{className:"portalTitle",children:"Portal Profesional"}),(0,s.jsx)("span",{className:"portalDesc",children:"Agenda, CRM, POS y operaciones."})]})]}),(0,s.jsxs)("form",{onSubmit:L,className:"loginForm",children:[(0,s.jsxs)("div",{className:"formGrid formGridTwo",children:[(0,s.jsxs)("div",{className:"field",children:[(0,s.jsx)("input",{className:"input",placeholder:" ",value:u,onChange:e=>m(e.target.value)}),(0,s.jsx)("label",{children:"Usuario"}),S.username&&(0,s.jsx)("span",{className:"fieldError",children:S.username})]}),(0,s.jsxs)("div",{className:"field",children:[(0,s.jsx)("input",{className:"input",placeholder:" ",type:"password",value:h,onChange:e=>p(e.target.value)}),(0,s.jsx)("label",{children:"Password"}),S.password&&(0,s.jsx)("span",{className:"fieldError",children:S.password})]})]}),(0,s.jsxs)("div",{className:"passwordMeter",children:[(0,s.jsx)("div",{className:"passwordBar strength-".concat(O)}),(0,s.jsxs)("span",{className:"small",children:["Seguridad: ",G]})]}),(0,s.jsx)("div",{className:"registerFields ".concat("register"===t?"open":"closed"),children:"register"===t&&(0,s.jsxs)("div",{className:"formGrid",style:{marginTop:10},children:[(0,s.jsxs)("div",{className:"field",children:[(0,s.jsx)("input",{className:"input",placeholder:" ",value:g,onChange:e=>x(e.target.value)}),(0,s.jsx)("label",{children:"Email"}),S.email&&(0,s.jsx)("span",{className:"fieldError",children:S.email})]}),(0,s.jsxs)("div",{className:"field",children:[(0,s.jsx)("input",{className:"input",placeholder:" ",value:j,onChange:e=>f(e.target.value)}),(0,s.jsx)("label",{children:"Nombre completo"}),S.fullName&&(0,s.jsx)("span",{className:"fieldError",children:S.fullName})]}),(0,s.jsxs)("div",{className:"field",children:[(0,s.jsx)("input",{className:"input",placeholder:" ",value:N,onChange:e=>v(e.target.value)}),(0,s.jsx)("label",{children:"Telefono"}),S.phone&&(0,s.jsx)("span",{className:"fieldError",children:S.phone})]})]})}),(0,s.jsxs)("div",{className:"authOptions",children:[(0,s.jsxs)("label",{className:"rememberCheck",children:[(0,s.jsx)("input",{type:"checkbox",checked:b,onChange:e=>y(e.target.checked)}),(0,s.jsx)("span",{children:"Recordarme"})]}),(0,s.jsx)("button",{className:"textBtn",type:"button",onClick:function(){T("Recuperacion: por ahora contactar soporte en soporte@nila.local.")},children:"Olvide mi clave"})]}),(0,s.jsx)("div",{className:"linkRow",children:(0,s.jsx)("button",{className:"linkBtn actionBtn",type:"submit",disabled:I,children:I?"Procesando...":P})}),(0,s.jsx)("div",{className:"authInlineSwitch",children:"login"===t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"small",children:"No tienes cuenta?"}),(0,s.jsx)("button",{className:"textBtn",type:"button",onClick:()=>{o("register"),w({})},children:"Crear una cuenta"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"small",children:"Ya tienes cuenta?"}),(0,s.jsx)("button",{className:"textBtn",type:"button",onClick:()=>{o("login"),w({})},children:"Iniciar sesion"})]})})]}),(0,s.jsx)("div",{className:"loginDivider",children:(0,s.jsx)("span",{children:"o continuar con"})}),_?(0,s.jsxs)("div",{className:"googleWrap",children:[(0,s.jsx)("div",{ref:a}),(0,s.jsx)("p",{className:"small",children:"Registro/Login social habilitado con Google."})]}):(0,s.jsxs)("div",{className:"googleWrap",children:[(0,s.jsx)("button",{className:"mutedBtn",type:"button",disabled:!0,children:"Google no configurado"}),(0,s.jsx)("p",{className:"small",children:"Define `GOOGLE_CLIENT_ID` para habilitar Google Sign-In."})]}),(0,s.jsx)("pre",{className:"pre",children:A})]})]})}},5739:(e,a,t)=>{"use strict";t.d(a,{A:()=>l,e:()=>r});let s="/api";async function n(e,a){let t=e.length>1&&e.endsWith("/")?e.slice(0,-1):e,n=["".concat(s).concat(t),"".concat(s).concat(t,"/")];for(let e=0;e<n.length;e+=1)try{let t=await fetch(n[e],a);if(404!==t.status||e===n.length-1)return t}catch(a){if(e===n.length-1)throw Error("Network error while contacting API")}throw Error("Unexpected API routing state")}async function l(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={};a.token&&(t.Authorization="Bearer ".concat(a.token)),a.tenantId&&(t["X-Tenant-ID"]=a.tenantId),void 0!==a.body&&(t["Content-Type"]="application/json");let s=await n(e,{method:a.method||"GET",headers:t,body:void 0!==a.body?JSON.stringify(a.body):void 0});if(!s.ok){let e=await s.text();throw Error("".concat(s.status," ").concat(s.statusText," :: ").concat(e))}return 204===s.status?{}:s.json()}function r(){return s}},4651:(e,a,t)=>{"use strict";t.d(a,{E1:()=>d,Ht:()=>c,dM:()=>u,q7:()=>m});let s="nila_token",n="nila_tenant_id",l="nila_user",r="nila_remember";function i(e){let a=localStorage.getItem(e);return null!==a?a:sessionStorage.getItem(e)||""}function o(e){localStorage.removeItem(e),sessionStorage.removeItem(e)}function c(){let e;let a=i(s),t=i(n),r=i(l);if(r)try{e=JSON.parse(r)}catch(a){e=void 0}return{token:a,tenantId:t,user:e}}function d(e){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=a?localStorage:sessionStorage,i=a?sessionStorage:localStorage;t.setItem(s,e.token),t.setItem(n,e.tenantId),e.user&&t.setItem(l,JSON.stringify(e.user)),t.setItem(r,a?"1":"0"),i.removeItem(s),i.removeItem(n),i.removeItem(l),i.removeItem(r)}function u(e){localStorage.setItem(n,e)}function m(){o(s),o(n),o(l),o(r)}},6046:(e,a,t)=>{"use strict";var s=t(6658);t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}})}},e=>{var a=a=>e(e.s=a);e.O(0,[441,517,358],()=>a(6001)),_N_E=e.O()}]);