(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[234],{4063:(e,t,n)=>{Promise.resolve().then(n.bind(n,4884))},4884:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var s=n(5155),a=n(8173),r=n.n(a),i=n(2115),o=n(6046),c=n(5739),l=n(4651);function d(){let e=(0,o.useRouter)(),[t,n]=(0,i.useState)(""),[a,d]=(0,i.useState)(""),[u,h]=(0,i.useState)([]),[m,g]=(0,i.useState)([]),[f,v]=(0,i.useState)("Nuevo Centro"),[x,j]=(0,i.useState)("nuevo-centro"),[N,p]=(0,i.useState)("Listo"),S=(0,i.useMemo)(()=>u.find(e=>String(e.id)===a),[u,a]);async function k(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;try{let[t,n]=await Promise.all([(0,c.A)("/tenants",{token:e}),(0,c.A)("/memberships",{token:e})]);h(t),g(n),p("Tenants actualizados")}catch(e){p("Error: ".concat(e.message))}}async function b(){try{let e=await (0,c.A)("/tenants",{method:"POST",token:t,body:{name:f,slug:x,plan:"starter",is_active:!0}});d(String(e.id)),(0,l.dM)(String(e.id)),await k(),p("Tenant creado: ".concat(e.name))}catch(e){p("Error creando tenant: ".concat(e.message))}}return(0,i.useEffect)(()=>{let t=(0,l.Ht)();if(!t.token){e.replace("/login");return}n(t.token),d(t.tenantId||""),k(t.token)},[e]),(0,s.jsxs)("main",{children:[(0,s.jsx)("div",{className:"brand",children:"NILA"}),(0,s.jsx)("div",{className:"brandTag",children:"Strategy \xb7 Technology \xb7 Execution"}),(0,s.jsx)("h1",{className:"sectionTitle",children:"Gestion Multi-tenant"}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("h2",{children:"Nuevo tenant"}),(0,s.jsxs)("div",{className:"formGrid",children:[(0,s.jsx)("input",{className:"input",value:f,onChange:e=>v(e.target.value),placeholder:"Nombre empresa"}),(0,s.jsx)("input",{className:"input",value:x,onChange:e=>j(e.target.value),placeholder:"Slug unico"}),(0,s.jsx)("button",{className:"linkBtn",onClick:b,children:"Crear tenant"})]})]}),(0,s.jsxs)("div",{className:"grid",children:[(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("h2",{children:"Tenant activo"}),S?(0,s.jsxs)("p",{children:[S.name," (",S.slug,")"]}):(0,s.jsx)("p",{children:"Sin tenant seleccionado."})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("h2",{children:"Mis memberships"}),(0,s.jsx)("ul",{className:"list",children:m.map(e=>(0,s.jsxs)("li",{children:["tenant #",e.tenant," - rol: ",e.role]},e.id))})]})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("h2",{children:"Tenants disponibles"}),(0,s.jsx)("ul",{className:"list",children:u.map(e=>(0,s.jsxs)("li",{children:[e.id," - ",e.name," (",e.slug,")",(0,s.jsx)("button",{className:"mutedBtn",style:{marginLeft:8},onClick:()=>(function(e){let t=String(e);d(t),(0,l.dM)(t),p("Tenant activo: ".concat(t))})(e.id),children:"Usar"})]},e.id))})]}),(0,s.jsxs)("div",{className:"linkRow",children:[(0,s.jsx)("button",{className:"linkBtn",onClick:()=>k(),children:"Refrescar"}),(0,s.jsx)(r(),{className:"mutedBtn",href:"/professional/dashboard",children:"Volver dashboard"}),(0,s.jsx)("button",{className:"mutedBtn",onClick:function(){(0,l.q7)(),e.push("/login")},children:"Cerrar sesion"})]}),(0,s.jsx)("pre",{className:"pre",children:N})]})}},5739:(e,t,n)=>{"use strict";n.d(t,{A:()=>r,e:()=>i});let s="/api";async function a(e,t){let n=e.length>1&&e.endsWith("/")?e.slice(0,-1):e,a=["".concat(s).concat(n),"".concat(s).concat(n,"/")];for(let e=0;e<a.length;e+=1)try{let n=await fetch(a[e],t);if(404!==n.status||e===a.length-1)return n}catch(t){if(e===a.length-1)throw Error("Network error while contacting API")}throw Error("Unexpected API routing state")}async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={};t.token&&(n.Authorization="Bearer ".concat(t.token)),t.tenantId&&(n["X-Tenant-ID"]=t.tenantId),void 0!==t.body&&(n["Content-Type"]="application/json");let s=await a(e,{method:t.method||"GET",headers:n,body:void 0!==t.body?JSON.stringify(t.body):void 0});if(!s.ok){let e=await s.text();throw Error("".concat(s.status," ").concat(s.statusText," :: ").concat(e))}return 204===s.status?{}:s.json()}function i(){return s}},4651:(e,t,n)=>{"use strict";n.d(t,{E1:()=>d,Ht:()=>l,dM:()=>u,q7:()=>h});let s="nila_token",a="nila_tenant_id",r="nila_user",i="nila_remember";function o(e){let t=localStorage.getItem(e);return null!==t?t:sessionStorage.getItem(e)||""}function c(e){localStorage.removeItem(e),sessionStorage.removeItem(e)}function l(){let e;let t=o(s),n=o(a),i=o(r);if(i)try{e=JSON.parse(i)}catch(t){e=void 0}return{token:t,tenantId:n,user:e}}function d(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=t?localStorage:sessionStorage,o=t?sessionStorage:localStorage;n.setItem(s,e.token),n.setItem(a,e.tenantId),e.user&&n.setItem(r,JSON.stringify(e.user)),n.setItem(i,t?"1":"0"),o.removeItem(s),o.removeItem(a),o.removeItem(r),o.removeItem(i)}function u(e){localStorage.setItem(a,e)}function h(){c(s),c(a),c(r),c(i)}},6046:(e,t,n)=>{"use strict";var s=n(6658);n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[173,441,517,358],()=>t(4063)),_N_E=e.O()}]);